{"version":3,"file":"react-loading-overlay-ts.cjs.production.min.js","sources":["../src/components/Spinner.tsx","../src/styles.tsx","../src/index.tsx"],"sourcesContent":["import { FC } from 'react';\r\nimport { css } from '@emotion/css';\r\n\r\nexport type SpinnerProps = {\r\n  getStyles: (key: string) => TemplateStringsArray;\r\n  cx: (name: string, arg2: any) => string;\r\n};\r\n\r\nconst Spinner: FC<SpinnerProps> = (props) => (\r\n  <div className={props.cx('spinner', css(props.getStyles('spinner')))}>\r\n    <svg viewBox=\"25 25 50 50\">\r\n      <circle\r\n        cx=\"50\"\r\n        cy=\"50\"\r\n        r=\"20\"\r\n        fill=\"none\"\r\n        strokeWidth=\"2\"\r\n        strokeMiterlimit=\"10\"\r\n      />\r\n    </svg>\r\n  </div>\r\n);\r\n\r\nexport default Spinner;\r\n","import { CSSInterpolation, keyframes } from '@emotion/css';\r\nimport { TransitionStatus } from 'react-transition-group/Transition';\r\n\r\nimport { LoadingOverLayProps, OverflowCSS } from './LoadingOverlayTypes';\r\n\r\nconst rotate360 = keyframes`\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n`;\r\n\r\nconst spinnerDash = keyframes`\r\n  0% {\r\n    stroke-dasharray: 1,200;\r\n    stroke-dashoffset: 0;\r\n  }\r\n  50% {\r\n    stroke-dasharray: 89,200;\r\n    stroke-dashoffset: -35px;\r\n  }\r\n  100% {\r\n    stroke-dasharray: 89,200;\r\n    stroke-dashoffset: -124px;\r\n  }\r\n`;\r\n\r\nexport type StyleKeys = 'wrapper' | 'overlay' | 'content' | 'spinner';\r\n\r\nexport type Styles<StateType = any> = {\r\n  [key in StyleKeys]?: (\r\n    state: StateType,\r\n    props?: LoadingOverLayProps\r\n  ) => CSSInterpolation | TemplateStringsArray;\r\n};\r\n\r\nconst styles: Styles = {\r\n  wrapper: (state: OverflowCSS) => ({\r\n    position: 'relative',\r\n    ...state,\r\n  }),\r\n  overlay(state: TransitionStatus, props?: LoadingOverLayProps) {\r\n    return {\r\n      position: 'absolute',\r\n      height: '100%',\r\n      width: '100%',\r\n      top: '0px',\r\n      left: '0px',\r\n      display: 'flex',\r\n      textAlign: 'center',\r\n      fontSize: '1.2em',\r\n      color: '#FFF',\r\n      backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n      zIndex: 800,\r\n      transition: `opacity ${props?.fadeSpeed ?? 500}ms ease-in`,\r\n      opacity: state === 'entering' || state === 'entered' ? 1 : 0,\r\n    };\r\n  },\r\n  content: () => ({\r\n    margin: 'auto',\r\n  }),\r\n  spinner: () => ({\r\n    position: 'relative',\r\n    margin: '0px auto 10px auto',\r\n    width: '50px',\r\n    maxHeight: '100%',\r\n    '&:before': {\r\n      content: '\"\"',\r\n      display: 'block',\r\n      paddingTop: '100%',\r\n    },\r\n    '& svg': {\r\n      animation: `${rotate360} 2s linear infinite`,\r\n      height: '100%',\r\n      transformOrigin: 'center center',\r\n      width: '100%',\r\n      position: 'absolute',\r\n      top: '0',\r\n      bottom: '0',\r\n      left: '0',\r\n      right: '0',\r\n      margin: 'auto',\r\n      '& circle': {\r\n        animation: `${spinnerDash} 1.5s ease-in-out infinite`,\r\n        strokeDasharray: '1,200',\r\n        strokeDashoffset: 0,\r\n        strokeLinecap: 'round',\r\n        stroke: '#FFF',\r\n      },\r\n    },\r\n  }),\r\n};\r\n\r\nexport default styles;\r\n","import { createRef, forwardRef, PureComponent } from 'react';\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport { css, CSSInterpolation, cx } from '@emotion/css';\r\nimport { TransitionStatus } from 'react-transition-group/Transition';\r\n\r\nimport Spinner, { SpinnerProps } from './components/Spinner';\r\n\r\nimport STYLES, { Styles } from './styles';\r\nimport {\r\n  LoadingOverLayProps,\r\n  LoadingOverlayState,\r\n  OverflowCSS,\r\n} from './LoadingOverlayTypes';\r\n\r\nexport { LoadingOverLayProps } from './LoadingOverlayTypes';\r\n\r\nclass LoadingOverlayWrapperBase extends PureComponent<\r\n  LoadingOverLayProps,\r\n  LoadingOverlayState\r\n> {\r\n  static displayName = 'LoadingOverlay';\r\n\r\n  wrapperEl: HTMLElement | null = null;\r\n\r\n  overlayRef = createRef<HTMLDivElement>();\r\n\r\n  state = { overflowCSS: undefined };\r\n\r\n  componentDidMount() {\r\n    this.wrapperEl = this.overlayRef.current?.parentElement ?? null;\r\n    if (this.wrapperEl !== null) {\r\n      const wrapperStyle = window.getComputedStyle(this.wrapperEl);\r\n      const overflowCSS = (\r\n        ['overflow', 'overflowX', 'overflowY'] as Array<keyof OverflowCSS>\r\n      ).reduce<OverflowCSS>((m, i) => {\r\n        if (wrapperStyle[i] !== 'visible') m[i] = 'hidden';\r\n        return m;\r\n      }, {} as OverflowCSS);\r\n      this.setState({ overflowCSS });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps: LoadingOverLayProps) {\r\n    const { active } = this.props;\r\n    if (active !== prevProps.active && this.wrapperEl) {\r\n      this.wrapperEl.scrollTop = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Return an emotion css object for a given element key\r\n   * If a custom style was provided via props, run it with\r\n   * the base css obj.\r\n   */\r\n  getStyles = (\r\n    key: keyof Styles,\r\n    providedState?: OverflowCSS | TransitionStatus\r\n  ) => {\r\n    const { styles = {} } = this.props;\r\n    const base = STYLES?.[key]?.(providedState, this.props);\r\n    const custom: Styles[keyof Styles] | boolean =\r\n      (styles as Styles)?.[key] ?? false;\r\n    if (!custom) return base;\r\n    return (\r\n      typeof custom === 'function' ? custom(base, this.props) : custom\r\n    ) as CSSInterpolation | TemplateStringsArray;\r\n  };\r\n\r\n  /**\r\n   * Convenience cx wrapper to add prefix classes to each of the child\r\n   * elements for styling purposes.\r\n   */\r\n  cx = (names: string | Array<string | false | undefined>, ...args: any) => {\r\n    const { classNamePrefix = '_loading_overlay_' } = this.props;\r\n    const arr = Array.isArray(names) ? names : [names];\r\n    return cx(\r\n      ...arr.map((name) => (name ? `${classNamePrefix}${name}` : '')),\r\n      ...args\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { overflowCSS } = this.state;\r\n    const {\r\n      children,\r\n      className,\r\n      onClick,\r\n      active,\r\n      fadeSpeed = 500,\r\n      spinner = true,\r\n      text,\r\n      innerRef,\r\n    } = this.props;\r\n\r\n    return (\r\n      <div\r\n        data-testid=\"wrapper\"\r\n        ref={innerRef}\r\n        className={this.cx(\r\n          ['wrapper', active && 'wrapper--active'],\r\n          css(\r\n            this.getStyles(\r\n              'wrapper',\r\n              active ? overflowCSS : undefined\r\n            ) as CSSInterpolation\r\n          ),\r\n          className\r\n        )}\r\n      >\r\n        <CSSTransition\r\n          in={active}\r\n          classNames=\"_loading-overlay-transition\"\r\n          timeout={fadeSpeed!}\r\n          unmountOnExit\r\n          nodeRef={this.overlayRef}\r\n        >\r\n          {(state) => (\r\n            <div\r\n              ref={this.overlayRef}\r\n              data-testid=\"overlay\"\r\n              className={this.cx(\r\n                'overlay',\r\n                css(this.getStyles('overlay', state) as CSSInterpolation)\r\n              )}\r\n              onClick={onClick}\r\n            >\r\n              <div\r\n                className={this.cx(\r\n                  'content',\r\n                  css(this.getStyles('content') as CSSInterpolation)\r\n                )}\r\n              >\r\n                {spinner &&\r\n                  (typeof spinner === 'boolean' ? (\r\n                    <Spinner\r\n                      cx={this.cx}\r\n                      getStyles={this.getStyles as SpinnerProps['getStyles']}\r\n                    />\r\n                  ) : (\r\n                    spinner\r\n                  ))}\r\n                {text}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CSSTransition>\r\n        {children}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst LoadingOverlayWrapper = forwardRef<HTMLDivElement, LoadingOverLayProps>(\r\n  (props, ref) => <LoadingOverlayWrapperBase innerRef={ref} {...props} />\r\n);\r\n\r\nexport default LoadingOverlayWrapper;\r\n"],"names":["Spinner","props","_jsx","className","cx","css","getStyles","children","jsx","viewBox","cy","r","fill","strokeWidth","strokeMiterlimit","rotate360","keyframes","name","styles","spinnerDash","wrapper","state","_extends","position","overlay","_props$fadeSpeed","height","width","top","left","display","textAlign","fontSize","color","backgroundColor","zIndex","transition","fadeSpeed","opacity","content","margin","spinner","maxHeight","paddingTop","animation","transformOrigin","bottom","right","strokeDasharray","strokeDashoffset","strokeLinecap","stroke","LoadingOverlayWrapperBase","_PureComponent","_this","_len","arguments","length","_args","Array","_key","call","apply","this","concat","wrapperEl","overlayRef","createRef","overflowCSS","undefined","key","providedState","_STYLES$key","_styles$key","_this$props$styles","base","STYLES","custom","names","_this$props$className","classNamePrefix","arr","isArray","_len2","args","_key2","map","_proto","prototype","componentDidMount","_this$overlayRef$curr","_this$overlayRef$curr2","current","parentElement","wrapperStyle","window","getComputedStyle","reduce","m","i","setState","componentDidUpdate","prevProps","active","scrollTop","render","_this2","_this$props","onClick","_this$props$fadeSpeed","_this$props$spinner","text","_jsxs","ref","innerRef","CSSTransition","in","classNames","timeout","unmountOnExit","nodeRef","jsxs","PureComponent","displayName","forwardRef"],"mappings":"qhBAQA,IAAMA,EAA4B,SAACC,GAAK,OACtCC,EAAAA,IAAK,MAAA,CAAAC,UAAWF,EAAMG,GAAG,UAAWC,EAAAA,IAAIJ,EAAMK,UAAU,mBAAYC,SAClEL,EAAKM,IAAA,MAAA,CAAAC,QAAQ,cACXF,SAAAL,EAAAM,IAAA,SAAA,CACEJ,GAAG,KACHM,GAAG,KACHC,EAAE,KACFC,KAAK,OACLC,YAAY,IACZC,iBAAiB,UAGjB,ECfFC,EAAYC,EAAAA,UAAS,CAAAC,KAAA,UAAAC,OAAA,+DASrBC,EAAcH,EAAAA,UAAS,CAAAC,KAAA,UAAAC,OAAA,gKAwBvBA,EAAiB,CACrBE,QAAS,SAACC,GAAkB,OAAAC,EAAA,CAC1BC,SAAU,YACPF,EACH,EACFG,QAAQH,SAAAA,EAAyBpB,GAA2B,IAAAwB,EAC1D,MAAO,CACLF,SAAU,WACVG,OAAQ,OACRC,MAAO,OACPC,IAAK,MACLC,KAAM,MACNC,QAAS,OACTC,UAAW,SACXC,SAAU,QACVC,MAAO,OACPC,gBAAiB,qBACjBC,OAAQ,IACRC,WAAU,YAA6B,OAA7BX,EAAaxB,MAAAA,OAAAA,EAAAA,EAAOoC,WAASZ,EAAI,KAAe,aAC1Da,QAAmB,aAAVjB,GAAkC,YAAVA,EAAsB,EAAI,EAE9D,EACDkB,QAAS,WAAA,MAAO,CACdC,OAAQ,OACR,EACFC,QAAS,WAAA,MAAO,CACdlB,SAAU,WACViB,OAAQ,qBACRb,MAAO,OACPe,UAAW,OACX,WAAY,CACVH,QAAS,KACTT,QAAS,QACTa,WAAY,QAEd,QAAS,CACPC,UAAc7B,EAA8B,sBAC5CW,OAAQ,OACRmB,gBAAiB,gBACjBlB,MAAO,OACPJ,SAAU,WACVK,IAAK,IACLkB,OAAQ,IACRjB,KAAM,IACNkB,MAAO,IACPP,OAAQ,OACR,WAAY,CACVI,UAAczB,EAAuC,6BACrD6B,gBAAiB,QACjBC,iBAAkB,EAClBC,cAAe,QACfC,OAAQ,SAGb,GC5EGC,EAA0B,SAAAC,WAAA,SAAAD,IAAA,IAAA,IAAAE,EAAAC,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GA+D7B,OA/D6BN,EAAAD,EAAAQ,KAAAC,MAAAT,EAAA,CAAAU,MAAAC,OAAAN,KAAAK,MAM9BE,UAAgC,KAAIX,EAEpCY,WAAaC,EAAAA,YAA2Bb,EAExCjC,MAAQ,CAAE+C,iBAAaC,GAAWf,EA4BlChD,UAAY,SACVgE,EACAC,GACE,IAAAC,EAAAC,EACsBC,EAAApB,EAAKrD,MAArBiB,OAAAA,OAAM,IAAAwD,EAAG,CAAA,EAAEA,EACbC,EAAOC,MAAAA,GAAA,OAAAA,EAAAA,EAASN,SAATM,EAAAJ,EAAAX,KAAAe,EAAgBL,EAAejB,EAAKrD,OAC3C4E,EACqB,SAAP,MAAjB3D,OAAiB,EAAjBA,EAAoBoD,KAAIG,EAC3B,OAAKI,EAEe,mBAAXA,EAAwBA,EAAOF,EAAMrB,EAAKrD,OAAS4E,EAFxCF,GAIrBrB,EAMDlD,GAAK,SAAC0E,GAE+C,IADnD,IAAkDC,EAAAzB,EAAKrD,MAA/C+E,gBAAAA,aAAkB,oBAAmBD,EACvCE,EAAMtB,MAAMuB,QAAQJ,GAASA,EAAQ,CAACA,GAAOK,EAAA3B,UAAAC,OAFO2B,EAAS,IAAAzB,MAAAwB,EAAA,EAAAA,EAAA,EAAA,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAATD,EAASC,EAAA,GAAA7B,UAAA6B,GAGnE,OAAOjF,EAAAA,GACF6E,WAAAA,EAAAA,EAAIK,KAAI,SAACrE,GAAI,OAAMA,EAAU+D,GAAAA,EAAkB/D,EAAS,MACxDmE,OAAAA,KAEN9B,CAAA,GA/D6BD,KAAAD,yEA+D7B,IAAAmC,EAAAnC,EAAAoC,UAsEA,OAtEAD,EAnDDE,kBAAA,WAAiB,IAAAC,EAAAC,EAEf,GADA5B,KAAKE,UAAkD,OAAtCyB,EAAA,OAAAC,EAAA5B,KAAKG,WAAW0B,cAAhB,EAAAD,EAAyBE,eAAaH,EAAI,KACpC,OAAnB3B,KAAKE,UAAoB,CAC3B,IAAM6B,EAAeC,OAAOC,iBAAiBjC,KAAKE,WAC5CG,EACJ,CAAC,WAAY,YAAa,aAC1B6B,QAAoB,SAACC,EAAGC,GAExB,MADwB,YAApBL,EAAaK,KAAkBD,EAAEC,GAAK,UACnCD,CACR,GAAE,CAAiB,GACpBnC,KAAKqC,SAAS,CAAEhC,YAAAA,GACjB,GACFmB,EAEDc,mBAAA,SAAmBC,GACEvC,KAAK9D,MAAhBsG,SACOD,EAAUC,QAAUxC,KAAKE,YACtCF,KAAKE,UAAUuC,UAAY,EAE/B,EAEAjB,EAgCAkB,OAAA,WAAM,IAAAC,EAAA3C,KAWA4C,EAAA5C,KAAK9D,MARPM,IAAAA,SACAJ,IAAAA,UACAyG,IAAAA,QACAL,IAAAA,OAAMM,EAAAF,EACNtE,UAAAA,aAAY,IAAGwE,EAAAC,EAAAH,EACflE,QAAAA,cAAcqE,EACdC,IAAAA,KAIF,OACEC,EAAAA,KAAA,MAAA,CAAA,cACc,UACZC,MANFC,SAOE/G,UAAW4D,KAAK3D,GACd,CAAC,UAAWmG,GAAU,mBACtBlG,EAAAA,IACE0D,KAAKzD,UACH,UACAiG,EArBcxC,KAAK1C,MAArB+C,iBAqByBC,GAE1B,GAAA,IACDlE,GACDI,SAAA,CAEDL,EAACM,IAAA2G,gBACC,CAAAC,GAAIb,EACJc,WAAW,8BACXC,QAASjF,EACTkF,iBACAC,QAASzD,KAAKG,WAAU3D,SAEvB,SAACc,GAAK,OACLnB,EAAAA,IACE,MAAA,CAAA+G,IAAKP,EAAKxC,WACE,cAAA,UACZ/D,UAAWuG,EAAKtG,GACd,UACAC,EAAGA,IAACqG,EAAKpG,UAAU,UAAWe,WAEhCuF,QAASA,EAETrG,SAAAyG,EAAAS,KAAA,MAAA,CACEtH,UAAWuG,EAAKtG,GACd,UACAC,EAAAA,IAAIqG,EAAKpG,UAAU,6BAGpBmC,IACqB,kBAAZA,EACNvC,EAAAM,IAACR,EAAO,CACNI,GAAIsG,EAAKtG,GACTE,UAAWoG,EAAKpG,YAGlBmC,GAEHsE,MAEC,IAGTxG,MAGN6C,CAAA,CArI6B,CAAQsE,EAGvCA,eAHKtE,EAIGuE,YAAc,iCAoIOC,EAAUA,YACtC,SAAC3H,EAAOgH,GAAG,OAAK/G,EAACM,IAAA4C,EAAyB9B,EAAA,CAAC4F,SAAUD,GAAShH,GAAS"}